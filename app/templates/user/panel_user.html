{% extends 'base.html' %}

{% block title %}Panel de Usuario - Tecno T@ctil{% endblock %}

{% block content %}
<div class="container py-5">
  <!-- Header de bienvenida -->
  <div class="text-center mb-5">
    <div class="d-inline-flex align-items-center justify-content-center rounded-circle mb-3" 
         style="width: 80px; height: 80px; background: var(--gradient-blue);">
      <i class="bi bi-person-circle text-white" style="font-size: 2.5rem;"></i>
    </div>
    <h1 class="titulo-profesional mb-2">¡Bienvenido, {{ current_user.name }}!</h1>
    <p class="text-muted lead">Gestiona tu cuenta y explora todas las funcionalidades disponibles</p>
  </div>

  <!-- Dashboard Cards Grid -->
  <div class="row g-4 mb-5">
    <!-- Card de estadísticas rápidas -->
    <div class="col-lg-3 col-md-6">
      <div class="card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px;">
        <div class="card-body text-center">
          <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
               style="width: 60px; height: 60px; background: linear-gradient(135deg, #28a745, #20c997);">
            <i class="bi bi-check-circle-fill text-white" style="font-size: 1.5rem;"></i>
          </div>
          <h5 class="fw-bold" style="color: var(--text-blue);">Cuenta Activa</h5>
          <p class="text-muted small mb-0">Estado de tu cuenta</p>
        </div>
      </div>
    </div>

    <!-- Card de notificaciones -->
    <div class="col-lg-3 col-md-6">
      <div class="card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px;">
        <div class="card-body text-center">
          <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
               style="width: 60px; height: 60px; background: linear-gradient(135deg, #ffc107, #fd7e14);">
            <i class="bi bi-bell-fill text-white" style="font-size: 1.5rem;"></i>
          </div>
          <h5 class="fw-bold" style="color: var(--text-blue);">3</h5>
          <p class="text-muted small mb-0">Notificaciones nuevas</p>
        </div>
      </div>
    </div>

    <!-- Card de último acceso -->
    <div class="col-lg-3 col-md-6">
      <div class="card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px;">
        <div class="card-body text-center">
          <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
               style="width: 60px; height: 60px; background: linear-gradient(135deg, #6f42c1, #e83e8c);">
            <i class="bi bi-clock-fill text-white" style="font-size: 1.5rem;"></i>
          </div>
          <h5 class="fw-bold" style="color: var(--text-blue);">Hoy</h5>
          <p class="text-muted small mb-0">Último acceso</p>
        </div>
      </div>
    </div>

    <!-- Card de nivel de usuario -->
    <div class="col-lg-3 col-md-6">
      <div class="card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px;">
        <div class="card-body text-center">
          <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
               style="width: 60px; height: 60px; background: var(--gradient-blue);">
            <i class="bi bi-star-fill text-white" style="font-size: 1.5rem;"></i>
          </div>
          <h5 class="fw-bold" style="color: var(--text-blue);">Básico</h5>
          <p class="text-muted small mb-0">Nivel de usuario</p>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN 1: DATOS PERSONALES -->
  <section id="datos-personales" class="mb-5">
    <div class="card glass-effect shadow-lg border-0" style="border-radius: 25px;">
      <div class="card-header border-0 text-center py-4" style="background: var(--gradient-blue); border-radius: 25px 25px 0 0;">
        <h5 class="text-white mb-0 fw-bold">
          <i class="bi bi-person-gear me-2"></i>Tus Datos Personales y Opciones de la Cuenta
        </h5>
      </div>
      <div class="card-body p-4">
        <div class="row g-3">
          <!-- Información personal en cards individuales -->
          <div class="col-md-6">
            <div class="info-card p-3" style="background: var(--soft-blue); border-radius: 15px; border-left: 4px solid var(--primary-blue);">
              <div class="d-flex align-items-center">
                <i class="bi bi-person-fill me-3" style="color: var(--primary-blue); font-size: 1.5rem;"></i>
                <div>
                  <small class="text-muted d-block">Nombre completo</small>
                  <strong style="color: var(--text-blue);">{{ current_user.name }}</strong>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="info-card p-3" style="background: var(--soft-blue); border-radius: 15px; border-left: 4px solid var(--primary-blue);">
              <div class="d-flex align-items-center">
                <i class="bi bi-envelope-fill me-3" style="color: var(--primary-blue); font-size: 1.5rem;"></i>
                <div>
                  <small class="text-muted d-block">Correo electrónico</small>
                  <strong style="color: var(--text-blue);">{{ current_user.email }}</strong>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="info-card p-3" style="background: var(--soft-blue); border-radius: 15px; border-left: 4px solid var(--primary-blue);">
              <div class="d-flex align-items-center">
                <i class="bi bi-shield-check me-3" style="color: var(--primary-blue); font-size: 1.5rem;"></i>
                <div>
                  <small class="text-muted d-block">Rol</small>
                  <strong style="color: var(--text-blue);">Usuario Normal</strong>
                </div>
              </div>
            </div>
          </div>

          {% if current_user.phone %}
          <div class="col-md-6">
            <div class="info-card p-3" style="background: var(--soft-blue); border-radius: 15px; border-left: 4px solid var(--primary-blue);">
              <div class="d-flex align-items-center">
                <i class="bi bi-telephone-fill me-3" style="color: var(--primary-blue); font-size: 1.5rem;"></i>
                <div>
                  <small class="text-muted d-block">Teléfono</small>
                  <strong style="color: var(--text-blue);">{{ current_user.phone }}</strong>
                </div>
              </div>
            </div>
          </div>
          {% endif %}
        </div>

        <!-- Acciones de cuenta -->
        <hr class="my-4">
        <div class="row g-3">
          <div class="col-md-6">
            <button class="btn btn-outline-primary w-100 rounded-pill" onclick="editProfile()">
              <i class="bi bi-pencil-square me-2"></i>Editar Perfil
            </button>
          </div>
          <div class="col-md-6">
            <button class="btn btn-outline-secondary w-100 rounded-pill" onclick="changePassword()">
              <i class="bi bi-key me-2"></i>Cambiar Contraseña
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCIÓN DE FUNCIONALIDADES PRINCIPALES -->
  <section id="funcionalidades-principales" class="mb-5">
    <div class="text-center mb-4">
      <h3 class="fw-bold" style="color: var(--text-blue);">
        <i class="bi bi-grid-3x3-gap-fill me-2"></i>Funcionalidades Principales
      </h3>
      <p class="text-muted">Explora todas las herramientas disponibles para ti</p>
    </div>

    <div class="row g-4">
      <!-- Blog y Publicaciones -->
      <div class="col-lg-6">
        <div class="feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; cursor: pointer;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 70px; height: 70px; background: linear-gradient(135deg, #17a2b8, #6610f2);">
              <i class="bi bi-journal-text text-white" style="font-size: 2rem;"></i>
            </div>
            <h5 class="fw-bold mb-3" style="color: var(--text-blue);">Blog y Publicaciones</h5>
            <p class="text-muted mb-4">Lee las últimas publicaciones tecnológicas y mantente informado sobre las novedades del sector.</p>
            <a href="{{ url_for('admin.blog') }}" class="btn btn-primary rounded-pill px-4">
              <i class="bi bi-arrow-right me-2"></i>Ir al Blog
            </a>
          </div>
        </div>
      </div>

      <!-- Contacto y Soporte -->
      <div class="col-lg-6">
        <div class="feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; cursor: pointer;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 70px; height: 70px; background: linear-gradient(135deg, #28a745, #17a2b8);">
              <i class="bi bi-headset text-white" style="font-size: 2rem;"></i>
            </div>
            <h5 class="fw-bold mb-3" style="color: var(--text-blue);">Contacto y Soporte</h5>
            <p class="text-muted mb-4">¿Necesitas ayuda? Ponte en contacto conmigo para resolver cualquier duda o consulta.</p>
            <a href="{{ url_for('main.contacto') }}" class="btn btn-primary rounded-pill px-4">
              <i class="bi bi-chat-dots me-2"></i>Contactar
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCIÓN DE FUTURAS FUNCIONALIDADES -->
  <section id="futuras-funcionalidades" class="mb-5">
    <div class="text-center mb-4">
      <h3 class="fw-bold" style="color: var(--text-blue);">
        <i class="bi bi-rocket-takeoff me-2"></i>Próximas Funcionalidades
      </h3>
      <p class="text-muted">Estas características estarán disponibles próximamente</p>
    </div>

    <div class="row g-4">
      <!-- Placeholder 1: Cursos -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #ffc107, #fd7e14);">
              <i class="bi bi-mortarboard text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Cursos Online</h6>
            <p class="text-muted small mb-3">Accede a cursos especializados en tecnología.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>

      <!-- Placeholder 2: Herramientas -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #6f42c1, #e83e8c);">
              <i class="bi bi-tools text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Herramientas Tech</h6>
            <p class="text-muted small mb-3">Utiliza herramientas exclusivas para desarrollo.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>

      <!-- Placeholder 3: Comunidad -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #20c997, #28a745);">
              <i class="bi bi-people text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Comunidad</h6>
            <p class="text-muted small mb-3">Conecta con otros usuarios y comparte experiencias.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>

      <!-- Placeholder 4: Certificaciones -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #dc3545, #fd7e14);">
              <i class="bi bi-award text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Certificaciones</h6>
            <p class="text-muted small mb-3">Obtén certificados profesionales en tecnología.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>

      <!-- Placeholder 5: Proyectos -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #17a2b8, #6610f2);">
              <i class="bi bi-kanban text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Gestión de Proyectos</h6>
            <p class="text-muted small mb-3">Gestiona tus proyectos tecnológicos personales.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>

      <!-- Placeholder 6: Analytics -->
      <div class="col-lg-4 col-md-6">
        <div class="future-feature-card card glass-effect h-100 border-0 shadow-lg" style="border-radius: 20px; opacity: 0.7;">
          <div class="card-body p-4 text-center">
            <div class="rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                 style="width: 60px; height: 60px; background: linear-gradient(135deg, #28a745, #17a2b8);">
              <i class="bi bi-graph-up text-white" style="font-size: 1.5rem;"></i>
            </div>
            <h6 class="fw-bold mb-3" style="color: var(--text-blue);">Estadísticas</h6>
            <p class="text-muted small mb-3">Visualiza tu progreso y estadísticas de uso.</p>
            <button class="btn btn-outline-secondary btn-sm rounded-pill" disabled>
              <i class="bi bi-clock me-1"></i>Próximamente
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SECCIÓN DE CONFIGURACIÓN Y OPCIONES -->
  <section id="configuracion" class="mb-5">
    <div class="card glass-effect shadow-lg border-0" style="border-radius: 25px;">
      <div class="card-header border-0 text-center py-4" style="background: linear-gradient(135deg, #6c757d, #495057); border-radius: 25px 25px 0 0;">
        <h5 class="text-white mb-0 fw-bold">
          <i class="bi bi-gear-fill me-2"></i>Configuración y Preferencias
        </h5>
      </div>
      <div class="card-body p-4">
        <div class="row g-3">
          <!-- Configuraciones rápidas -->
          <div class="col-md-6">
            <div class="d-flex align-items-center justify-content-between p-3" style="background: var(--soft-blue); border-radius: 15px;">
              <div class="d-flex align-items-center">
                <i class="bi bi-bell me-3" style="color: var(--primary-blue); font-size: 1.2rem;"></i>
                <span style="color: var(--text-blue);">Notificaciones por email</span>
              </div>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="d-flex align-items-center justify-content-between p-3" style="background: var(--soft-blue); border-radius: 15px;">
              <div class="d-flex align-items-center">
                <i class="bi bi-moon me-3" style="color: var(--primary-blue); font-size: 1.2rem;"></i>
                <span style="color: var(--text-blue);">Modo oscuro</span>
              </div>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="darkMode">
              </div>
            </div>
          </div>
        </div>

        <hr class="my-4">
        
        <!-- Botones de acción -->
        <div class="row g-3">
          <div class="col-md-4">
            <button class="btn btn-outline-info w-100 rounded-pill" onclick="downloadData()">
              <i class="bi bi-download me-2"></i>Descargar mis datos
            </button>
          </div>
          <div class="col-md-4">
            <button class="btn btn-outline-warning w-100 rounded-pill" onclick="exportPreferences()">
              <i class="bi bi-upload me-2"></i>Exportar preferencias
            </button>
          </div>
          <div class="col-md-4">
            <button class="btn btn-outline-danger w-100 rounded-pill" onclick="deleteAccount()">
              <i class="bi bi-trash me-2"></i>Eliminar cuenta
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- BOTÓN CERRAR SESIÓN -->
  <div class="text-center">
    <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-primary btn-lg rounded-pill px-5">
      <i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesión
    </a>
  </div>
</div>

<!-- Estilos específicos del panel de usuario -->
<style>
  /* Efectos hover para las cards de funcionalidades */
  .feature-card {
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .feature-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 40px rgba(0, 102, 204, 0.2) !important;
  }

  .feature-card:hover .rounded-circle {
    transform: scale(1.1);
    transition: transform 0.3s ease;
  }

  /* Efectos para futuras funcionalidades */
  .future-feature-card {
    transition: all 0.3s ease;
    position: relative;
  }

  .future-feature-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: repeating-linear-gradient(
      45deg,
      transparent,
      transparent 10px,
      rgba(0, 102, 204, 0.03) 10px,
      rgba(0, 102, 204, 0.03) 20px
    );
    border-radius: 20px;
    pointer-events: none;
  }

  .future-feature-card:hover {
    opacity: 0.9 !important;
    transform: translateY(-3px);
  }

  /* Cards de información personal */
  .info-card {
    transition: all 0.3s ease;
  }

  .info-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 102, 204, 0.1);
  }

  /* Switches personalizados */
  .form-check-input:checked {
    background-color: var(--primary-blue);
    border-color: var(--primary-blue);
  }

  .form-check-input:focus {
    box-shadow: 0 0 0 0.25rem rgba(0, 102, 204, 0.25);
  }

  /* Animaciones de entrada */
  .card {
    animation: fadeInUp 0.8s ease-out;
  }

  .row > div {
    animation: fadeInUp 0.8s ease-out;
    animation-fill-mode: both;
  }

  .row > div:nth-child(1) { animation-delay: 0.1s; }
  .row > div:nth-child(2) { animation-delay: 0.2s; }
  .row > div:nth-child(3) { animation-delay: 0.3s; }
  .row > div:nth-child(4) { animation-delay: 0.4s; }
  .row > div:nth-child(5) { animation-delay: 0.5s; }
  .row > div:nth-child(6) { animation-delay: 0.6s; }

  /* Responsive */
  @media (max-width: 768px) {
    .titulo-profesional {
      font-size: 2rem;
    }
    
    .card {
      border-radius: 20px !important;
    }
    
    .card-header {
      border-radius: 20px 20px 0 0 !important;
    }

    .feature-card:hover {
      transform: translateY(-4px);
    }
  }

  /* Efectos de pulso para notificaciones */
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }

  .notification-pulse {
    animation: pulse 2s infinite;
  }
</style>

<!-- JavaScript para funcionalidades interactivas -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Funciones para botones de perfil
    window.editProfile = function() {
        alert('Funcionalidad de editar perfil - Próximamente disponible');
        // Aquí puedes agregar la lógica para editar perfil
    };

    window.changePassword = function() {
        alert('Funcionalidad de cambiar contraseña - Próximamente disponible');
        // Aquí puedes agregar la lógica para cambiar contraseña
    };

    // Funciones para configuración
    window.downloadData = function() {
        alert('Descarga de datos - Próximamente disponible');
        // Aquí puedes agregar la lógica para descargar datos
    };

    window.exportPreferences = function() {
        alert('Exportar preferencias - Próximamente disponible');
        // Aquí puedes agregar la lógica para exportar preferencias
    };

    window.deleteAccount = function() {
        if (confirm('¿Estás seguro de que quieres eliminar tu cuenta? Esta acción no se puede deshacer.')) {
            alert('Eliminar cuenta - Próximamente disponible');
            // Aquí puedes agregar la lógica para eliminar cuenta
        }
    };

    // Manejo de switches de configuración
    const emailNotifications = document.getElementById('emailNotifications');
    const darkMode = document.getElementById('darkMode');

    emailNotifications.addEventListener('change', function() {
        console.log('Notificaciones por email:', this.checked);
        // Aquí puedes guardar la preferencia
    });

    darkMode.addEventListener('change', function() {
        console.log('Modo oscuro:', this.checked);
        // Aquí puedes implementar el cambio de tema
    });

    // Efectos visuales adicionales
    const featureCards = document.querySelectorAll('.feature-card');
    featureCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-8px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });

    // Animación de contadores (simulada)
    const counters = document.querySelectorAll('.card-body h5');
    counters.forEach(counter => {
        if (counter.textContent.match(/^\d+$/)) {
            const finalValue = parseInt(counter.textContent);
            let currentValue = 0;
            const increment = Math.ceil(finalValue / 20);
            
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= finalValue) {
                    counter.textContent = finalValue;
                    clearInterval(timer);
                } else {
                    counter.textContent = currentValue;
                }
            }, 50);
        }
    });
});
</script>
{% endblock %}